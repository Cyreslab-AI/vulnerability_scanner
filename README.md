# Advanced Vulnerability Scanner

The Advanced Vulnerability Scanner is a powerful tool designed for integration into DevOps pipelines. It analyzes frameworks and libraries used in codebases for the latest vulnerabilities, providing comprehensive security insights and continuous monitoring capabilities.

## Features

1. **Multi-Ecosystem Support**: Analyzes dependencies for PyPI, npm, RubyGems, and Maven ecosystems.
2. **Enhanced Vulnerability Data Sources**: Utilizes multiple vulnerability databases, including OSV and NVD, for comprehensive vulnerability detection.
3. **Dependency Tree Analysis**: Examines the entire dependency tree, including transitive dependencies, to identify vulnerabilities throughout the project structure.
4. **Version Range Checking**: Improved vulnerability checking that considers version ranges affected by vulnerabilities, not just exact version matches.
5. **Continuous Monitoring and Alerting**: Performs scheduled scans and sends email alerts for newly detected vulnerabilities.
6. **Interactive CLI**: Provides a visually appealing console output using rich text formatting.
7. **Web-based User Interface**: Offers an easy-to-use web interface for running scans and configuring the tool.
8. **Dependency Graph Visualization**: Generates a visual representation of the project's dependency structure in the HTML report.
9. **Docker Container Scanning**: Scans Docker images for potential vulnerabilities.
10. **License Compliance Checking**: Ensures that package licenses comply with project requirements.
11. **Customizable Vulnerability Severity Thresholds**: Allows setting minimum severity levels for reporting.
12. **Multiple Output Formats**: Generates reports in console, JSON, and enhanced HTML formats.
13. **Automatic Dependency File Detection**: Detects the appropriate dependency file and ecosystem automatically.
14. **Plugin Architecture**: Supports custom plugins for extending functionality.

## Installation

1. Clone the repository:
   ```
   git clone https://github.com/Cyreslab-AI/vulnerability_scanner.git
   cd vulnerability_scanner
   ```

2. Install the package and its dependencies:
   ```
   pip install .
   ```

## Usage

### CLI Interface

Run the vulnerability scanner with:

```
vuln-scan --config config.yaml
```

For automatic dependency file detection, simply run:

```
vuln-scan
```

### Command-line Options

- `--config`: Path to the configuration file
- `--dependencies`: Path to the dependencies file
- `--ecosystem`: Package ecosystem (PyPI, npm, RubyGems, or Maven)
- `--output`: Output format (text, json, or html)
- `--min-severity`: Minimum severity level to report (LOW, MODERATE, HIGH, or CRITICAL)

## Configuration

Create a `config.yaml` file with the following structure:

```yaml
dependencies_file: path/to/dependencies.file
ecosystem: PyPI  # or npm, RubyGems, Maven
output_format: html  # or json, text
min_severity: MODERATE  # or LOW, HIGH, CRITICAL
scan_docker: true
continuous_monitoring: false
monitoring_interval: 24  # in hours
allowed_licenses:
  - MIT
  - Apache-2.0
  - BSD
alert_email:
  sender: your_email@example.com
  receiver: alert_receiver@example.com
  smtp_server: smtp.example.com
  smtp_port: 587
  username: your_username
  password: your_password
```

## Development

### Running Tests

To run the test suite:

```
python -m unittest discover tests
```

### Adding Plugins

Create a new Python file in the `plugins` directory. Each plugin should have a `register_plugin()` function that returns an object with `pre_scan` and/or `post_scan` methods.

## Contributing

Please read [CONTRIBUTING.md](CONTRIBUTING.md) for details on our code of conduct and the process for submitting pull requests.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## Acknowledgments

- Thanks to all contributors who have helped shape this project.
- Special thanks to the open-source community for providing the tools and libraries that make this project possible.
